import{a as x}from"./chunk-SOZETVW7.js";import"./chunk-4HNKWMBY.js";import{a as T,b as h,c as R,d as N,f as q,g as L,h as k,i as w,k as D}from"./chunk-R3YEN3BX.js";import{e as O}from"./chunk-C6P2FJG4.js";import{h as E}from"./chunk-IJX6AT3I.js";import{Cb as C,Db as F,Lb as l,Ta as s,Tb as A,Wb as y,ba as v,ea as b,jb as m,lb as S,pb as p,tb as o,ub as n,vb as c}from"./chunk-CCXG73UJ.js";var I=(e,t)=>({"is-invalid":e,"is-valid":t});function G(e,t){e&1&&(o(0,"div",6)(1,"p",13),l(2,"details is Required"),n()())}function M(e,t){e&1&&(o(0,"p",13),l(1,"phone is Required"),n())}function B(e,t){e&1&&(o(0,"p",13),l(1,"Invalid Phone"),n())}function P(e,t){if(e&1&&(o(0,"div",6),m(1,M,2,0,"p",13)(2,B,2,0),n()),e&2){let a,r=F();s(),p(1,(a=r.shippingAddressForm.get("phone"))!=null&&a.getError("required")?1:(a=r.shippingAddressForm.get("phone"))!=null&&a.getError("pattern")?2:-1)}}function V(e,t){e&1&&(o(0,"p",13),l(1,"city is Required"),n())}function j(e,t){if(e&1&&(o(0,"div",6),m(1,V,2,0,"p",13),n()),e&2){let a,r=F();s(),p(1,(a=r.shippingAddressForm.get("city"))!=null&&a.getError("required")?1:-1)}}function $(e,t){e&1&&c(0,"i",12)}var Z=(()=>{let t=class t{constructor(){this._FormBuilder=v(w),this._ActivatedRoute=v(O),this._OrdersService=v(x),this.isLoading=!1,this.msgSuccess=!1,this.shippingAddressForm=this._FormBuilder.group({details:[null,[h.required]],phone:[null,[h.required,h.pattern(/^01[0125][0-9]{8}$/)]],city:[null,[h.required]]})}ngOnInit(){this.ActivatedRouteSub=this._ActivatedRoute.paramMap.subscribe({next:r=>{this.cartIdToPaid=r.get("cartId")}})}submitShippingAddressForm(){this.shippingAddressForm.valid&&!this.isLoading?(this.isLoading=!0,this.OrdersServiceSub=this._OrdersService.checkOut(this.cartIdToPaid,this.shippingAddressForm.value).subscribe({next:r=>{r.status=="success"&&(this.msgSuccess=!0,this.isLoading=!1,window.open(r.session.url,"_self"))},error:r=>{console.log(r.error),this.isLoading=!1}})):this.shippingAddressForm.markAllAsTouched()}ngOnDestroy(){this.ActivatedRouteSub?.unsubscribe(),this.OrdersServiceSub?.unsubscribe()}};t.\u0275fac=function(g){return new(g||t)},t.\u0275cmp=b({type:t,selectors:[["app-orders"]],standalone:!0,features:[A],decls:22,vars:10,consts:[[1,"w-75","mx-auto","bg-main-light","px-2","py-4","my-3","shadow","rounded-2"],[1,"h3","mb-4","fw-medium","text-main"],[3,"ngSubmit","formGroup"],[1,"mt-2"],["for","details"],["formControlName","details","id","details",1,"form-control"],[1,"alert","alert-danger","mt-1"],["for","phone"],["formControlName","phone","id","phone","type","tel",1,"form-control",3,"ngClass"],["for","city"],["formControlName","city","id","city","type","text",1,"form-control"],["type","submit",1,"btn","btn-outline-info","mt-3","w-100",3,"click","disabled"],[1,"fas","fa-spin","fa-spinner"],[1,"m-0"]],template:function(g,i){if(g&1&&(o(0,"section",0)(1,"h1",1),l(2,"Delivery information :"),n(),o(3,"form",2),C("ngSubmit",function(){return i.submitShippingAddressForm()}),o(4,"div",3)(5,"label",4),l(6,"details :"),n(),c(7,"textarea",5),m(8,G,3,0,"div",6),n(),o(9,"div",3)(10,"label",7),l(11,"phone :"),n(),c(12,"input",8),m(13,P,3,1,"div",6),n(),o(14,"div",3)(15,"label",9),l(16,"city :"),n(),c(17,"input",10),m(18,j,2,1,"div",6),n(),o(19,"button",11),C("click",function(){return i.submitShippingAddressForm()}),l(20," check out "),m(21,$,1,0,"i",12),n()()()),g&2){let u,d,f,_;s(3),S("formGroup",i.shippingAddressForm),s(5),p(8,(u=i.shippingAddressForm.get("details"))!=null&&u.errors&&((u=i.shippingAddressForm.get("details"))!=null&&u.touched)?8:-1),s(4),S("ngClass",y(7,I,((d=i.shippingAddressForm.get("phone"))==null?null:d.errors)&&(((d=i.shippingAddressForm.get("phone"))==null?null:d.touched)||((d=i.shippingAddressForm.get("phone"))==null?null:d.dirty)),!((d=i.shippingAddressForm.get("phone"))!=null&&d.errors))),s(),p(13,(f=i.shippingAddressForm.get("phone"))!=null&&f.errors&&((f=i.shippingAddressForm.get("phone"))!=null&&f.touched)?13:-1),s(5),p(18,(_=i.shippingAddressForm.get("city"))!=null&&_.errors&&((_=i.shippingAddressForm.get("city"))!=null&&_.touched)?18:-1),s(),S("disabled",i.shippingAddressForm.invalid||i.isLoading||i.msgSuccess),s(2),p(21,i.isLoading?21:-1)}},dependencies:[D,q,T,R,N,L,k,E]});let e=t;return e})();export{Z as OrdersComponent};
