import './polyfills.server.mjs';
import{a as V}from"./chunk-YOUQJUOR.mjs";import{a as L,b as g,c as A,d as N,f as q,g as R,h as I,i as k,k as B}from"./chunk-OP5MZPS4.mjs";import"./chunk-6AIGYBES.mjs";import{k as T}from"./chunk-NMIYAXY6.mjs";import{j as b}from"./chunk-G7SPZNB4.mjs";import{$ as P,Ab as d,Ib as a,Jb as C,Qa as l,Qb as y,Tb as w,X as x,gb as u,ib as _,ja as v,ka as F,mb as c,qb as s,rb as r,sb as p,vb as h,zb as E}from"./chunk-WBN27DHN.mjs";import"./chunk-VVCT4QZE.mjs";var S=(e,o)=>({"is-invalid":e,"is-valid":o});function D(e,o){e&1&&(s(0,"p",9),a(1,"email is Required"),r())}function G(e,o){e&1&&(s(0,"p",9),a(1,"Enter Valid Email "),r())}function M(e,o){if(e&1&&(s(0,"div",6),u(1,D,2,0,"p",9)(2,G,2,0),r()),e&2){let t,i=d(2);l(),c(1,(t=i.verifyEmailForm.get("email"))!=null&&t.getError("required")?1:(t=i.verifyEmailForm.get("email"))!=null&&t.getError("email")?2:-1)}}function z(e,o){if(e&1&&(s(0,"div",10)(1,"p",9),a(2),r()()),e&2){let t=d(3);l(2),C(t.msgError)}}function Z(e,o){if(e&1&&(s(0,"div",11)(1,"p",9),a(2),r()()),e&2){let t=d(3);l(2),C(t.msgSuccess)}}function $(e,o){if(e&1&&u(0,z,3,1,"div",10)(1,Z,3,1),e&2){let t=d(2);c(0,t.msgError?0:t.msgSuccess?1:-1)}}function j(e,o){e&1&&p(0,"i",8)}function O(e,o){if(e&1){let t=h();s(0,"form",2),E("ngSubmit",function(){v(t);let n=d();return F(n.submitVerifyEmailForm())}),s(1,"div",3)(2,"label",4),a(3,"email :"),r(),p(4,"input",5),u(5,M,3,1,"div",6)(6,$,2,1),r(),s(7,"button",7),a(8," verifyEmail "),u(9,j,1,0,"i",8),r()()}if(e&2){let t,i,n=d();_("formGroup",n.verifyEmailForm),l(4),_("ngClass",w(5,S,((t=n.verifyEmailForm.get("email"))==null?null:t.errors)&&(((t=n.verifyEmailForm.get("email"))==null?null:t.touched)||((t=n.verifyEmailForm.get("email"))==null?null:t.dirty)),!((t=n.verifyEmailForm.get("email"))!=null&&t.errors))),l(),c(5,(i=n.verifyEmailForm.get("email"))!=null&&i.errors&&((i=n.verifyEmailForm.get("email"))!=null&&i.touched)?5:6),l(2),_("disabled",n.verifyEmailForm.invalid||n.isLoading||n.msgSuccess),l(2),c(9,n.isLoading?9:-1)}}function U(e,o){e&1&&(s(0,"p",9),a(1,"resetCode is Required"),r())}function H(e,o){e&1&&(s(0,"p",9),a(1," Reset Code must be 6 Numbers "),r())}function J(e,o){if(e&1&&(s(0,"div",6),u(1,U,2,0,"p",9)(2,H,2,0),r()),e&2){let t,i=d(2);l(),c(1,(t=i.verifyCodeForm.get("resetCode"))!=null&&t.getError("required")?1:(t=i.verifyCodeForm.get("resetCode"))!=null&&t.getError("pattern")?2:-1)}}function K(e,o){if(e&1&&(s(0,"div",10)(1,"p",9),a(2),r()()),e&2){let t=d(3);l(2),C(t.msgError)}}function Q(e,o){if(e&1&&(s(0,"div",11)(1,"p",9),a(2),r()()),e&2){let t=d(3);l(2),C(t.msgSuccess)}}function W(e,o){if(e&1&&u(0,K,3,1,"div",10)(1,Q,3,1),e&2){let t=d(2);c(0,t.msgError?0:t.msgSuccess?1:-1)}}function X(e,o){e&1&&p(0,"i",8)}function Y(e,o){if(e&1){let t=h();s(0,"form",2),E("ngSubmit",function(){v(t);let n=d();return F(n.submitVerifyCodeForm())}),s(1,"div",3)(2,"label",12),a(3,"Reset Code :"),r(),p(4,"input",13),u(5,J,3,1,"div",6)(6,W,2,1),r(),s(7,"button",7),a(8," Verify Code "),u(9,X,1,0,"i",8),r()()}if(e&2){let t,i,n=d();_("formGroup",n.verifyCodeForm),l(4),_("ngClass",w(5,S,((t=n.verifyCodeForm.get("resetCode"))==null?null:t.errors)&&(((t=n.verifyCodeForm.get("resetCode"))==null?null:t.touched)||((t=n.verifyCodeForm.get("resetCode"))==null?null:t.dirty)),!((t=n.verifyCodeForm.get("resetCode"))!=null&&t.errors))),l(),c(5,(i=n.verifyCodeForm.get("resetCode"))!=null&&i.errors&&((i=n.verifyCodeForm.get("resetCode"))!=null&&i.touched)?5:6),l(2),_("disabled",n.verifyCodeForm.invalid||n.isLoading||n.msgSuccess),l(2),c(9,n.isLoading?9:-1)}}function ee(e,o){e&1&&(s(0,"p",9),a(1,"email is Required"),r())}function te(e,o){e&1&&(s(0,"p",9),a(1,"Enter Valid Email "),r())}function ie(e,o){if(e&1&&(s(0,"div",6),u(1,ee,2,0,"p",9)(2,te,2,0),r()),e&2){let t,i=d(2);l(),c(1,(t=i.verifyEmailForm.get("email"))!=null&&t.getError("required")?1:(t=i.verifyEmailForm.get("email"))!=null&&t.getError("email")?2:-1)}}function ne(e,o){e&1&&(s(0,"p",9),a(1,"password is Required"),r())}function oe(e,o){e&1&&(s(0,"p",9),a(1," * Start with a letter (either uppercase or lowercase). "),p(2,"br"),a(3," * Be between 6 and 9 characters in total. "),p(4,"br"),a(5," * Can only contain letters (A-Z or a-z) and numbers (0-9) "),p(6,"br"),r())}function re(e,o){if(e&1&&(s(0,"div",6),u(1,ne,2,0,"p",9)(2,oe,7,0),r()),e&2){let t,i=d(2);l(),c(1,(t=i.newPasswordForm.get("newPassword"))!=null&&t.getError("required")?1:(t=i.newPasswordForm.get("newPassword"))!=null&&t.getError("pattern")?2:-1)}}function se(e,o){if(e&1&&(s(0,"div",10)(1,"p",9),a(2),r()()),e&2){let t=d(2);l(2),C(t.msgError)}}function le(e,o){if(e&1&&(s(0,"div",11)(1,"p",9),a(2),r()()),e&2){let t=d(2);l(2),C(t.msgSuccess)}}function ae(e,o){e&1&&p(0,"i",8)}function me(e,o){if(e&1){let t=h();s(0,"form",2),E("ngSubmit",function(){v(t);let n=d();return F(n.submitNewPasswordForm())}),s(1,"div",3)(2,"label",4),a(3,"email :"),r(),p(4,"input",14),u(5,ie,3,1,"div",6),r(),s(6,"div",3)(7,"label",15),a(8,"newPassword :"),r(),p(9,"input",16),u(10,re,3,1,"div",6),r(),u(11,se,3,1,"div",10)(12,le,3,1),s(13,"button",7),a(14," newPassword "),u(15,ae,1,0,"i",8),r()()}if(e&2){let t,i,n,f,m=d();_("formGroup",m.newPasswordForm),l(4),_("ngClass",w(8,S,((t=m.newPasswordForm.get("email"))==null?null:t.errors)&&(((t=m.newPasswordForm.get("email"))==null?null:t.touched)||((t=m.newPasswordForm.get("email"))==null?null:t.dirty)),!((t=m.newPasswordForm.get("email"))!=null&&t.errors))),l(),c(5,(i=m.newPasswordForm.get("email"))!=null&&i.errors&&((i=m.newPasswordForm.get("email"))!=null&&i.touched)?5:-1),l(4),_("ngClass",w(11,S,((n=m.newPasswordForm.get("newPassword"))==null?null:n.errors)&&(((n=m.newPasswordForm.get("newPassword"))==null?null:n.touched)||((n=m.newPasswordForm.get("newPassword"))==null?null:n.dirty)),!((n=m.newPasswordForm.get("newPassword"))!=null&&n.errors))),l(),c(10,(f=m.newPasswordForm.get("newPassword"))!=null&&f.errors&&((f=m.newPasswordForm.get("newPassword"))!=null&&f.touched)?10:-1),l(),c(11,m.msgError?11:m.msgSuccess?12:-1),l(2),_("disabled",m.newPasswordForm.invalid||m.isLoading||m.msgSuccess),l(2),c(15,m.isLoading?15:-1)}}var xe=(()=>{let o=class o{constructor(){this._FormBuilder=x(k),this._AuthService=x(V),this._Router=x(T),this.userEmail="",this.msgSuccess="",this.msgError="",this.isLoading=!1,this.step=1,this.verifyEmailForm=this._FormBuilder.group({email:[null,[g.required,g.email]]}),this.verifyCodeForm=this._FormBuilder.group({resetCode:[null,[g.required,g.pattern(/^[0-9]{6}$/)]]}),this.newPasswordForm=this._FormBuilder.group({email:[null,[g.required,g.email]],newPassword:[null,[g.required,g.pattern(/^([a-zA-Z]{1}[a-zA-Z0-9]{5,9})$/)]]})}submitVerifyEmailForm(){this.verifyEmailForm.valid&&!this.isLoading&&this.msgSuccess==""?(this.isLoading=!0,this.sendVerifyEmailSub=this._AuthService.sendVerifyEmail(this.verifyEmailForm.value).subscribe({next:i=>{i.statusMsg=="success"?(this.userEmail=this.verifyEmailForm.get("email")?.value,this.newPasswordForm.get("email")?.patchValue(this.userEmail),this.msgSuccess=i.message,this.isLoading=!1,setTimeout(()=>{this.msgSuccess="",this.msgError="",this.step=2},4e3)):this.msgError=i.message},error:i=>{console.log(i.error),this.msgError=i.error.message,this.isLoading=!1}})):this.verifyEmailForm.markAllAsTouched()}submitVerifyCodeForm(){this.verifyCodeForm.valid&&!this.isLoading&&this.msgSuccess==""?(this.isLoading=!0,this.sendVerifyCodeSub=this._AuthService.sendVerifyCode(this.verifyCodeForm.value).subscribe({next:i=>{i.status=="Success"?(console.log(i),this.isLoading=!1,this.msgSuccess="",this.msgError="",this.step=3):this.msgError=i.message},error:i=>{console.log(i.error),this.msgError=i.error.message,this.isLoading=!1}})):this.verifyCodeForm.markAllAsTouched()}submitNewPasswordForm(){this.newPasswordForm.valid&&!this.isLoading&&this.msgSuccess==""?(this.isLoading=!0,this.setNewPasswordSub=this._AuthService.setNewPassword(this.newPasswordForm.value).subscribe({next:i=>{this.msgSuccess=i.message,this.isLoading=!1,localStorage.setItem("userToken",i.token),this._AuthService.saveUserData(),setTimeout(()=>{this.msgSuccess="",this.msgError="",this._Router.navigate(["/home"])},4e3)},error:i=>{console.log(i.error),this.msgError=i.error.message,this.isLoading=!1}})):this.newPasswordForm.markAllAsTouched()}ngOnDestroy(){this.sendVerifyEmailSub?.unsubscribe(),this.sendVerifyCodeSub?.unsubscribe(),this.setNewPasswordSub?.unsubscribe()}};o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=P({type:o,selectors:[["app-forget-password"]],standalone:!0,features:[y],decls:6,vars:1,consts:[[1,"w-75","mx-auto","my-1"],[1,"h3","fw-medium","text-main"],[3,"ngSubmit","formGroup"],[1,"mt-2"],["for","email"],["formControlName","email","id","email","type","text",1,"form-control",3,"ngClass"],[1,"alert","alert-danger","mt-1"],["type","submit",1,"btn-main","px-4","mt-3",3,"disabled"],[1,"fas","fa-spin","fa-spinner"],[1,"m-0"],[1,"alert","mt-1","alert-danger"],[1,"alert","mt-1","alert-info"],["for","resetCode"],["formControlName","resetCode","id","resetCode","type","text",1,"form-control",3,"ngClass"],["formControlName","email","id","email","type","email",1,"form-control",3,"ngClass"],["for","newPassword"],["formControlName","newPassword","id","newPassword","type","text",1,"form-control",3,"ngClass"]],template:function(n,f){if(n&1&&(s(0,"section",0)(1,"h1",1),a(2,"Forget Password"),r(),u(3,O,10,8)(4,Y,10,8)(5,me,16,14),r()),n&2){let m;l(3),c(3,(m=f.step)===1?3:m===2?4:m===3?5:-1)}},dependencies:[B,q,L,A,N,R,I,b]});let e=o;return e})();export{xe as ForgetPasswordComponent};
